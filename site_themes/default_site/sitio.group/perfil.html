{embed="sitio/head" my_body_class="perfil" my_active_nav="perfil" my_page_title="Perfil | {title}"}
<div id="content">
	<div class="container">
		<div class="row">
			<h3>{if logged_in_member_id == "{segment_3}"}Mi  {/if}Perfil</h3>

		</div>
		<div class="row">

			<!-- ///////////////////////////////  Sidebar ///////////////////////////////   -->
			<div class="col-sm-3">
				{if segment_3}
					{embed="sitio/perfil-sidebar"}
				{if:else}
				<h4>Error!</h4><p>You must specify a member ID to view a profile.</p>
				{/if}
			</div>

			<!-- ///////////////////////////////  Contenido ///////////////////////////////   -->



			<div class="col-sm-8">

				<!-- ///////////////////////////////  Nombre de usuario y descripcion ///////////////////////////////   -->
				<div class="row">
					<div class="col-sm-12">
						{if segment_3}
						{exp:user:stats member_id="{segment_3}" limit="1"}
						<h2>
							{screen_name} <br>
							<small>
								{bio}  
							</small>
						</h2>
						<p>
							<b>6000 </b><span>Puntos</span> <br>
							<b>15 </b><span>Medallas</span> <br>
							<b>Nivel Experto</b>
						</p>
						{/exp:user:stats}

						{if:else}
						<h4>Error!</h4><p>You must specify a member ID to view a profile.</p>
						{/if}
					</div>
				</div>

				<!-- ///////////////////////////////  Badges ///////////////////////////////   -->


				<div class="row">
					<div class="col-sm-12">
						<h3>Badges</h3>

						<ul class="list-inline">

							{exp:channel:entries channel="badges_asignados"  search:usuario_receptor_badge="{segment_3}"  dynamic="no" limit="15" paginate="bottom"}
							
							<li class="item-badge">
								<img  height="63" width="63" class="img-circle item-img" src="{lista_badges:imagen_badge}" alt="">
							</li> 

							{if no_results}<span>This user has not posted any entries.</span>{/if}


							{paginate}<li>Page {current_page} of {total_pages} page{if total_pages > "1"}s{/if} &nbsp; &nbsp; &nbsp; {pagination_links}</li>{/paginate}

							{/exp:channel:entries}
						</ul>
					</div>
				</div>

				<!-- ///////////////////////////////  Apuestas ///////////////////////////////   -->
				<div class="row">
					<div class="col-sm-12">
						<h3>Apuestas jugadas</h3>



						{exp:channel:entries channel="predicciones"  search:pre_id_de_usuario="{segment_3}"  dynamic="no" limit="15" paginate="bottom"}


						<div class="row item-partido-perfil">
							<div class="col-sm-4 text-center">
								<div class="row">
									{partido_rel}
										{partido_rel:equipo_local}
											<div class="col-sm-6">
												{partido_rel:equipo_local:nombre_de_pais}<br>
												<img class="img-circle" src="{partido_rel:equipo_local:bandera_seleccion}" alt="{partido_rel:equipo_local:nombre_de_pais}"  height="72" width="72" >
											</div>
										{/partido_rel:equipo_local}

										{partido_rel:equipo_visitante}
											<div class="col-sm-6">
												{partido_rel:equipo_visitante:nombre_de_pais}<br>
												<img class="img-circle" src="{partido_rel:equipo_visitante:bandera_seleccion}" alt="{partido_rel:equipo_visitante:nombre_de_pais}" height="72" width="72" >	
											</div>
										{/partido_rel:equipo_visitante}
									{/partido_rel}	
								</div>
								<div class="row">
									<div class="col-sm-6">
										{pre_marcador_local}	
									</div>
									<div class="col-sm-6">
										{pre_marcador_visitante}
									</div>
								</div>
							</div>

							<div class="col-sm-4 text-center">
								<h4>2000 <br>
									<small>
										puntos
									</small>
								</h4>
							</div>
						</div>


						{if no_results}<span>This user has not posted any entries.</span>{/if}


						{paginate}<li>Page {current_page} of {total_pages} page{if total_pages > "1"}s{/if} &nbsp; &nbsp; &nbsp; {pagination_links}</li>{/paginate}

						{/exp:channel:entries}



					</div>
				</div>

				<!-- ///////////////////////////////  Dar Badge ///////////////////////////////   -->
				<div class="row">
					<div class="col-sm-12">



						<h3>
							Â¿Quieres darle un badge a esta persona?
						</h3>
						
						<div id="slider-badges">

							{exp:channel:entries channel="badges"  dynamic="no" }


								<div class="item">

									<img alt="{entry_id}"  height="63" width="63" class="img-circle item-img" src="{imagen_badge}" alt="">
								</div> 


							{if no_results}<span>This user has not posted any entries.</span>{/if}

							{/exp:channel:entries}
						</div>
						<br>


						<script type="text/javascript">
						$(document).ready(function(){
							$('#publishForm').ajaxForm({
								dataType: 'json',
								success: function(data) {
									if (data.success == '1') {
										//alert('You successfully added a new entry with entry_id '+data.entry_id);
										if(alert('Le haz dado un badge a tu amigo')){}
										else    window.location.reload(); 

									} else if (data.success == '0') {					
										$('#mensajes').append(data.field_errors.title);
										$('#mensajes').append(data.field_errors.lista_badges);                 		
											 // alert('Failed with the following errors: '+ data.errors.join(', '));
											}
										}
									});

							$('img.item-img').click(function () {
								$('select[name="lista_badges[data][]"]').find('option[value="' + $(this).attr("alt") + '"]').attr("selected",true);

								if (!$(this).hasClass('bdActive')) {
							    // Remove the class from anything that is active
							    $('img.item-img.bdActive').removeClass('bdActive');
							    // And make this active
							    $(this).addClass('bdActive');
							  }
							});
							$('#slider-badges').slick({
							  dots: true,
							  infinite: false,
							  speed: 300,
							  slidesToShow: 6,
							  slidesToScroll: 6,
							  responsive: [
							    {
							      breakpoint: 1024,
							      settings: {
							        slidesToShow: 5,
							        slidesToScroll: 5,
							        infinite: true,
							        dots: true
							      }
							    },
							    {
							      breakpoint: 600,
							      settings: {
							        slidesToShow: 4,
							        slidesToScroll: 4
							      }
							    },
							    {
							      breakpoint: 480,
							      settings: {
							        slidesToShow: 3,
							        slidesToScroll: 3
							      }
							    }
							  ]
							});
						});

						</script>
						{exp:channel:form channel="badges_asignados" return="site/ENTRY_ID" json="yes"}

						<input type="hidden" name="usuario_receptor_badge" id="usuario_receptor_badge" value="{segment_3}">
						<input type="hidden" name="title" id="title" value="{username}-id-{logged_in_member_id}-bad-{segment_3}-{entry_date}" size="50" maxlength="100" onkeyup="liveUrlTitle();">
						<div class="sr-only">

							{field:lista_badges}		

							<hr>
							<p class="text-center">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quos, soluta aliquid ad et in maxime velit sed atque esse adipisci.
							</p>
						</div>

						<input type="submit" value="Dar Badge" class="btn btn-success col-sm-12">

						{/exp:channel:form}
						<div id="mensajes">
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<!-- Vinculos para registros y perfiles en footer -->
{embed="sitio/foot"}